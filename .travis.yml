sudo: required
dist: trusty
group: deprecated-2017Q4
language: node_js
node_js:
- node
cache:
  directories:
  - node_modules
install:
- npm install
before_script:
- openssl aes-256-cbc -K $encrypted_5a94740118c9_key -iv $encrypted_5a94740118c9_iv -in github_deploy_key.enc -out github_deploy_key -d
- git config --global user.email "contact.ajanin@gmail.com"
- git config --global user.name "Alexandra JANIN"
script:
- npm test
env:
  global:
  - USE_YARN=no
  - CI=true
  - secure: BE4yJU0+iicDu37+nmVxldUA10V7eJgo+fvL3cXU68j5hgowfZGcr95Qy3xk1PhDDqiRFcX7VGYM3NfFGgjdJwt5FZ7s/FBtUwfmLtDw7SEn6SsDYpLxbnT2FDL94yPDNRakMDK0p549qkRn/xNothSIyaik8eYrt1DEnp5viJ4=
after_success:
- |

      $(npm bin)/set-up-ssh --key "$encrypted_XXXXXXXXXXXX_key" \
                            --iv "$encrypted_XXXXXXXXXXXX_iv" \
                            --path-encrypted-key ".travis/github_deploy_key.enc"
- if [ "$TRAVIS_PULL_REQUEST" = 'false' ] && [ "$TRAVIS_BRANCH" = "master" ]; then
  npm run deploy; fi
deploy:
  provider: releases
  api_key:
    secure: BE4yJU0+iicDu37+nmVxldUA10V7eJgo+fvL3cXU68j5hgowfZGcr95Qy3xk1PhDDqiRFcX7VGYM3NfFGgjdJwt5FZ7s/FBtUwfmLtDw7SEn6SsDYpLxbnT2FDL94yPDNRakMDK0p549qkRn/xNothSIyaik8eYrt1DEnp5viJ4=
  file_glob: true
  file: build/*/**
  skip_cleanup: true
  on:
    repo: sudweb/talks
    tags: true
